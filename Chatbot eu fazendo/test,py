from agno.tools.googlesheets import GoogleSheetsTools

# ID da sua planilha
SPREADSHEET_ID = "1gU14rrzskA3hJT8aJcYCFYlK3Rr3zvWyjni68ABfL5w"

# Caminho do JSON da conta de serviÃ§o
SERVICE_ACCOUNT_PATH = "service_account.json"

# Instancia o conector
gs = GoogleSheetsTools(
    enable_create_sheet=True,
    enable_read_sheet=True,
    enable_update_sheet=True,
    service_account_path=SERVICE_ACCOUNT_PATH,
    spreadsheet_id=SPREADSHEET_ID,
)

# ğŸ” Teste 1 â€” listar abas
print("ğŸ“„ Abas encontradas:")
print(gs.get_sheet_names())

# ğŸ” Teste 2 â€” ler conteÃºdo da primeira aba
first_sheet = gs.get_sheet_names()[0]
print(f"\nğŸ“– Lendo conteÃºdo da aba: {first_sheet}")
data = gs.read_sheet(f"{first_sheet}!A1:E10")
print(data)

# ğŸ” Teste 3 â€” atualizar cÃ©lula
print("\nâœï¸ Atualizando cÃ©lula de teste...")
gs.update_sheet(f"{first_sheet}!A1", [["âœ… ConexÃ£o funcionando!"]])
print("âœ… AtualizaÃ§Ã£o feita com sucesso!")
